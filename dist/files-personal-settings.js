/*! For license information please see files-personal-settings.js.LICENSE.txt */
!function(){"use strict";var n,e={92646:function(n,e,r){var s=r(20144),i=r(22200),o=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"section",attrs:{id:"files-personal-settings"}},[r("h2",[n._v(n._s(n.t("files","Files")))]),n._v(" "),r("TransferOwnershipDialogue")],1)};o._withStripped=!0;var a=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",[r("h3",[n._v(n._s(n.t("files","Transfer ownership of a file or folder"))+" ")]),n._v(" "),r("form",{on:{submit:function(e){return e.preventDefault(),n.submit.apply(null,arguments)}}},[r("p",{staticClass:"transfer-select-row"},[r("span",[n._v(n._s(n.readableDirectory))]),n._v(" "),void 0===n.directory?r("NcButton",{on:{click:function(e){return e.preventDefault(),n.start.apply(null,arguments)}}},[n._v("\n\t\t\t\t"+n._s(n.t("files","Choose file or folder to transfer"))+"\n\t\t\t")]):r("NcButton",{on:{click:function(e){return e.preventDefault(),n.start.apply(null,arguments)}}},[n._v("\n\t\t\t\t"+n._s(n.t("files","Change"))+"\n\t\t\t")]),n._v(" "),r("span",{staticClass:"error"},[n._v(n._s(n.directoryPickerError))])],1),n._v(" "),r("p",{staticClass:"new-owner-row"},[r("label",{attrs:{for:"targetUser"}},[r("span",[n._v(n._s(n.t("files","New owner")))])]),n._v(" "),r("NcMultiselect",{staticClass:"middle-align",attrs:{id:"targetUser",options:n.formatedUserSuggestions,multiple:!1,searchable:!0,placeholder:n.t("files","Search users"),"preselect-first":!0,"preserve-search":!0,loading:n.loadingUsers,"track-by":"user",label:"displayName","internal-search":!1,"clear-on-select":!1,"user-select":!0},on:{"search-change":n.findUserDebounced},model:{value:n.selectedUser,callback:function(e){n.selectedUser=e},expression:"selectedUser"}})],1),n._v(" "),r("p",[r("input",{staticClass:"primary",attrs:{type:"submit",disabled:!n.canSubmit},domProps:{value:n.submitButtonText}}),n._v(" "),r("span",{staticClass:"error"},[n._v(n._s(n.submitError))])])])])};a._withStripped=!0;var l,u=r(4820),c=r(20296),f=r.n(c),d=r(79753),p=r(26932),h=r(98266),v=r.n(h),g=r(10861),m=r.n(g),b=r(17499),w=null===(l=(0,i.getCurrentUser)())?(0,b.IY)().setApp("files").build():(0,b.IY)().setApp("files").setUid(l.uid).build();function A(n,e,r,t,s,i,o){try{var a=n[i](o),l=a.value}catch(n){return void r(n)}a.done?e(l):Promise.resolve(l).then(t,s)}var y=(0,p.fn)(t("files","Choose a file or folder to transfer")).setMultiSelect(!1).setModal(!0).setType(1).allowDirectories().build(),C={name:"TransferOwnershipDialogue",components:{NcMultiselect:v(),NcButton:m()},data:function(){return{directory:void 0,directoryPickerError:void 0,submitError:void 0,loadingUsers:!1,selectedUser:null,userSuggestions:{},config:{minSearchStringLength:parseInt(OC.config["sharing.minSearchStringLength"],10)||0}}},computed:{canSubmit:function(){return!!this.directory&&!!this.selectedUser},formatedUserSuggestions:function(){var n=this;return Object.keys(this.userSuggestions).map((function(e){var r=n.userSuggestions[e];return{user:r.uid,displayName:r.displayName,icon:"icon-user"}}))},submitButtonText:function(){if(!this.canSubmit)return t("files","Transfer");var n=this.readableDirectory.split("/");return t("files","Transfer {path} to {userid}",{path:n[n.length-1],userid:this.selectedUser.displayName})},readableDirectory:function(){return this.directory?this.directory.substring(1):""}},created:function(){this.findUserDebounced=f()(this.findUser,300),this.findUser("")},methods:{start:function(){var n=this;this.directoryPickerError=void 0,y.pick().then((function(n){return""===n?"/":n})).then((function(e){if(w.debug("path ".concat(e," selected for transferring ownership")),!e.startsWith("/"))throw new Error(t("files","Invalid path selected"));n.directory=e})).catch((function(e){w.error("Selecting object for transfer aborted: ".concat(e.message||"Unknown error"),{error:e}),n.directoryPickerError=e.message||t("files","Unknown error")}))},findUser:function(n){var e,r=this;return(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.query=n.trim(),!(n.length<r.config.minSearchStringLength)){e.next=3;break}return e.abrupt("return");case 3:return r.loadingUsers=!0,e.prev=4,e.next=7,u.default.get((0,d.generateOcsUrl)("apps/files_sharing/api/v1/sharees"),{params:{format:"json",itemType:"file",search:n,perPage:20,lookup:!1}});case 7:t=e.sent,r.userSuggestions={},t.data.ocs.data.exact.users.concat(t.data.ocs.data.users).forEach((function(n){s.ZP.set(r.userSuggestions,n.value.shareWith,{uid:n.value.shareWith,displayName:n.label})})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),w.error("could not fetch users",{error:e.t0});case 15:return e.prev=15,r.loadingUsers=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[4,12,15,18]])})),function(){var n=this,r=arguments;return new Promise((function(t,s){var i=e.apply(n,r);function o(n){A(i,t,s,o,a,"next",n)}function a(n){A(i,t,s,o,a,"throw",n)}o(void 0)}))})()},submit:function(){var n=this;this.canSubmit||w.warn("ignoring form submit"),this.submitError=void 0;var e={path:this.directory,recipient:this.selectedUser.user};w.debug("submit transfer ownership form",e);var r=(0,d.generateOcsUrl)("apps/files/api/v1/transferownership");u.default.post(r,e).then((function(n){return n.data})).then((function(e){w.info("Transfer ownership request sent",{data:e}),n.directory=void 0,n.selectedUser=null,(0,p.s$)(t("files","Ownership transfer request sent"))})).catch((function(e){var r;w.error("Could not send ownership transfer request",{error:e}),403===(null==e||null===(r=e.response)||void 0===r?void 0:r.status)?n.submitError=t("files","Cannot transfer ownership of a file or folder you do not own"):n.submitError=e.message||t("files","Unknown error")}))}}},_=C,x=r(93379),S=r.n(x),U=r(7795),k=r.n(U),O=r(90569),T=r.n(O),E=r(3565),D=r.n(E),P=r(19216),j=r.n(P),B=r(44589),N=r.n(B),Z=r(90136),I={};I.styleTagTransform=N(),I.setAttributes=D(),I.insert=T().bind(null,"head"),I.domAPI=k(),I.insertStyleElement=j(),S()(Z.Z,I),Z.Z&&Z.Z.locals&&Z.Z.locals;var M=r(51900),q=(0,M.Z)(_,a,[],!1,null,"76fb0136",null);q.options.__file="apps/files/src/components/TransferOwnershipDialogue.vue";var R={name:"PersonalSettings",components:{TransferOwnershipDialogue:q.exports}},W=(0,M.Z)(R,o,[],!1,null,null,null);W.options.__file="apps/files/src/components/PersonalSettings.vue";var Y=W.exports;r.nc=btoa((0,i.getRequestToken)()),s.ZP.prototype.t=t,window.TESTING||(new(s.ZP.extend(Y))).$mount("#files-personal-settings")},90136:function(n,e,r){var t=r(87537),s=r.n(t),i=r(23645),o=r.n(i)()(s());o.push([n.id,".middle-align[data-v-76fb0136]{vertical-align:middle}p[data-v-76fb0136]{margin-top:12px;margin-bottom:12px}.new-owner-row[data-v-76fb0136]{display:flex}.new-owner-row label[data-v-76fb0136]{display:flex;align-items:center}.new-owner-row label span[data-v-76fb0136]{margin-right:8px}.new-owner-row .multiselect[data-v-76fb0136]{flex-grow:1;max-width:280px}.transfer-select-row span[data-v-76fb0136]{margin-right:8px}","",{version:3,sources:["webpack://./apps/files/src/components/TransferOwnershipDialogue.vue"],names:[],mappings:"AAkOA,+BACC,qBAAA,CAED,mBACC,eAAA,CACA,kBAAA,CAED,gCACC,YAAA,CAEA,sCACC,YAAA,CACA,kBAAA,CAEA,2CACC,gBAAA,CAIF,6CACC,WAAA,CACA,eAAA,CAID,2CACC,gBAAA",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.middle-align {\r\n\tvertical-align: middle;\r\n}\r\np {\r\n\tmargin-top: 12px;\r\n\tmargin-bottom: 12px;\r\n}\r\n.new-owner-row {\r\n\tdisplay: flex;\r\n\r\n\tlabel {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\r\n\t\tspan {\r\n\t\t\tmargin-right: 8px;\r\n\t\t}\r\n\t}\r\n\r\n\t.multiselect {\r\n\t\tflex-grow: 1;\r\n\t\tmax-width: 280px;\r\n\t}\r\n}\r\n.transfer-select-row {\r\n\tspan {\r\n\t\tmargin-right: 8px;\r\n\t}\r\n}\r\n"],sourceRoot:""}]),e.Z=o}},r={};function s(n){var t=r[n];if(void 0!==t)return t.exports;var i=r[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,s),i.loaded=!0,i.exports}s.m=e,s.amdD=function(){throw new Error("define cannot be used indirect")},s.amdO={},n=[],s.O=function(e,r,t,i){if(!r){var o=1/0;for(c=0;c<n.length;c++){r=n[c][0],t=n[c][1],i=n[c][2];for(var a=!0,l=0;l<r.length;l++)(!1&i||o>=i)&&Object.keys(s.O).every((function(n){return s.O[n](r[l])}))?r.splice(l--,1):(a=!1,i<o&&(o=i));if(a){n.splice(c--,1);var u=t();void 0!==u&&(e=u)}}return e}i=i||0;for(var c=n.length;c>0&&n[c-1][2]>i;c--)n[c]=n[c-1];n[c]=[r,t,i]},s.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return s.d(e,{a:e}),e},s.d=function(n,e){for(var r in e)s.o(e,r)&&!s.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),s.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},s.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},s.nmd=function(n){return n.paths=[],n.children||(n.children=[]),n},s.j=1623,function(){s.b=document.baseURI||self.location.href;var n={1623:0};s.O.j=function(e){return 0===n[e]};var e=function(e,r){var t,i,o=r[0],a=r[1],l=r[2],u=0;if(o.some((function(e){return 0!==n[e]}))){for(t in a)s.o(a,t)&&(s.m[t]=a[t]);if(l)var c=l(s)}for(e&&e(r);u<o.length;u++)i=o[u],s.o(n,i)&&n[i]&&n[i][0](),n[i]=0;return s.O(c)},r=self.webpackChunknextcloud=self.webpackChunknextcloud||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}(),s.nc=void 0;var i=s.O(void 0,[7874],(function(){return s(92646)}));i=s.O(i)}();
//# sourceMappingURL=files-personal-settings.js.map?v=a651e76fe631dda791ff