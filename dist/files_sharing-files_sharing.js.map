{"version":3,"file":"files_sharing-files_sharing.js?v=f38cf86715b8bdc3429c","mappings":"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","sources":["webpack:///nextcloud/apps\\files_sharing\\js\\app.js","webpack:///nextcloud/apps\\files_sharing\\js\\sharedfilelist.js","webpack:///nextcloud/webpack\\bootstrap","webpack:///nextcloud/webpack\\runtime\\compat get default export","webpack:///nextcloud/webpack\\runtime\\define property getters","webpack:///nextcloud/webpack\\runtime\\hasOwnProperty shorthand"],"sourcesContent":["/**\r\n * Copyright (c) 2014 Vincent Petry <pvince81@owncloud.com>\r\n *\r\n * This file is licensed under the Affero General Public License version 3\r\n * or later.\r\n *\r\n * See the COPYING-README file.\r\n *\r\n */\r\n\r\nif (!OCA.Sharing) {\r\n\t/**\r\n\t * @namespace OCA.Sharing\r\n\t */\r\n\tOCA.Sharing = {}\r\n}\r\n\r\n/**\r\n * @namespace\r\n */\r\nOCA.Sharing.App = {\r\n\r\n\t_inFileList: null,\r\n\t_outFileList: null,\r\n\t_overviewFileList: null,\r\n\t_pendingFileList: null,\r\n\r\n\tinitSharingIn($el) {\r\n\t\tif (this._inFileList) {\r\n\t\t\treturn this._inFileList\r\n\t\t}\r\n\r\n\t\tthis._inFileList = new OCA.Sharing.FileList(\r\n\t\t\t$el,\r\n\t\t\t{\r\n\t\t\t\tid: 'shares.self',\r\n\t\t\t\tsharedWithUser: true,\r\n\t\t\t\tfileActions: this._createFileActions(),\r\n\t\t\t\tconfig: OCA.Files.App.getFilesConfig(),\r\n\t\t\t\t// The file list is created when a \"show\" event is handled, so\r\n\t\t\t\t// it should be marked as \"shown\" like it would have been done\r\n\t\t\t\t// if handling the event with the file list already created.\r\n\t\t\t\tshown: true,\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\tthis._extendFileList(this._inFileList)\r\n\t\tthis._inFileList.appName = t('files_sharing', 'Shared with you')\r\n\t\tthis._inFileList.$el.find('.emptyfilelist.emptycontent').html('<div class=\"icon-shared\"></div>'\r\n\t\t\t+ '<h2>' + t('files_sharing', 'Nothing shared with you yet') + '</h2>'\r\n\t\t\t+ '<p>' + t('files_sharing', 'Files and folders others share with you will show up here') + '</p>')\r\n\t\treturn this._inFileList\r\n\t},\r\n\r\n\tinitSharingOut($el) {\r\n\t\tif (this._outFileList) {\r\n\t\t\treturn this._outFileList\r\n\t\t}\r\n\t\tthis._outFileList = new OCA.Sharing.FileList(\r\n\t\t\t$el,\r\n\t\t\t{\r\n\t\t\t\tid: 'shares.others',\r\n\t\t\t\tsharedWithUser: false,\r\n\t\t\t\tfileActions: this._createFileActions(),\r\n\t\t\t\tconfig: OCA.Files.App.getFilesConfig(),\r\n\t\t\t\t// The file list is created when a \"show\" event is handled, so\r\n\t\t\t\t// it should be marked as \"shown\" like it would have been done\r\n\t\t\t\t// if handling the event with the file list already created.\r\n\t\t\t\tshown: true,\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\tthis._extendFileList(this._outFileList)\r\n\t\tthis._outFileList.appName = t('files_sharing', 'Shared with others')\r\n\t\tthis._outFileList.$el.find('.emptyfilelist.emptycontent').html('<div class=\"icon-shared\"></div>'\r\n\t\t\t+ '<h2>' + t('files_sharing', 'Nothing shared yet') + '</h2>'\r\n\t\t\t+ '<p>' + t('files_sharing', 'Files and folders you share will show up here') + '</p>')\r\n\t\treturn this._outFileList\r\n\t},\r\n\r\n\tinitSharingLinks($el) {\r\n\t\tif (this._linkFileList) {\r\n\t\t\treturn this._linkFileList\r\n\t\t}\r\n\t\tthis._linkFileList = new OCA.Sharing.FileList(\r\n\t\t\t$el,\r\n\t\t\t{\r\n\t\t\t\tid: 'shares.link',\r\n\t\t\t\tlinksOnly: true,\r\n\t\t\t\tfileActions: this._createFileActions(),\r\n\t\t\t\tconfig: OCA.Files.App.getFilesConfig(),\r\n\t\t\t\t// The file list is created when a \"show\" event is handled, so\r\n\t\t\t\t// it should be marked as \"shown\" like it would have been done\r\n\t\t\t\t// if handling the event with the file list already created.\r\n\t\t\t\tshown: true,\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\tthis._extendFileList(this._linkFileList)\r\n\t\tthis._linkFileList.appName = t('files_sharing', 'Shared by link')\r\n\t\tthis._linkFileList.$el.find('.emptyfilelist.emptycontent').html('<div class=\"icon-public\"></div>'\r\n\t\t\t+ '<h2>' + t('files_sharing', 'No shared links') + '</h2>'\r\n\t\t\t+ '<p>' + t('files_sharing', 'Files and folders you share by link will show up here') + '</p>')\r\n\t\treturn this._linkFileList\r\n\t},\r\n\r\n\tinitSharingDeleted($el) {\r\n\t\tif (this._deletedFileList) {\r\n\t\t\treturn this._deletedFileList\r\n\t\t}\r\n\t\tthis._deletedFileList = new OCA.Sharing.FileList(\r\n\t\t\t$el,\r\n\t\t\t{\r\n\t\t\t\tid: 'shares.deleted',\r\n\t\t\t\tdefaultFileActionsDisabled: true,\r\n\t\t\t\tshowDeleted: true,\r\n\t\t\t\tsharedWithUser: true,\r\n\t\t\t\tfileActions: this._restoreShareAction(),\r\n\t\t\t\tconfig: OCA.Files.App.getFilesConfig(),\r\n\t\t\t\t// The file list is created when a \"show\" event is handled, so\r\n\t\t\t\t// it should be marked as \"shown\" like it would have been done\r\n\t\t\t\t// if handling the event with the file list already created.\r\n\t\t\t\tshown: true,\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\tthis._extendFileList(this._deletedFileList)\r\n\t\tthis._deletedFileList.appName = t('files_sharing', 'Deleted shares')\r\n\t\tthis._deletedFileList.$el.find('.emptyfilelist.emptycontent').html('<div class=\"icon-share\"></div>'\r\n\t\t\t+ '<h2>' + t('files_sharing', 'No deleted shares') + '</h2>'\r\n\t\t\t+ '<p>' + t('files_sharing', 'Shares you deleted will show up here') + '</p>')\r\n\t\treturn this._deletedFileList\r\n\t},\r\n\r\n\tinitSharingPening($el) {\r\n\t\tif (this._pendingFileList) {\r\n\t\t\treturn this._pendingFileList\r\n\t\t}\r\n\t\tthis._pendingFileList = new OCA.Sharing.FileList(\r\n\t\t\t$el,\r\n\t\t\t{\r\n\t\t\t\tid: 'shares.pending',\r\n\t\t\t\tshowPending: true,\r\n\t\t\t\tdetailsViewEnabled: false,\r\n\t\t\t\tdefaultFileActionsDisabled: true,\r\n\t\t\t\tsharedWithUser: true,\r\n\t\t\t\tfileActions: this._acceptShareAction(),\r\n\t\t\t\tconfig: OCA.Files.App.getFilesConfig(),\r\n\t\t\t\t// The file list is created when a \"show\" event is handled, so\r\n\t\t\t\t// it should be marked as \"shown\" like it would have been done\r\n\t\t\t\t// if handling the event with the file list already created.\r\n\t\t\t\tshown: true,\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\tthis._extendFileList(this._pendingFileList)\r\n\t\tthis._pendingFileList.appName = t('files_sharing', 'Pending shares')\r\n\t\tthis._pendingFileList.$el.find('.emptyfilelist.emptycontent').html('<div class=\"icon-share\"></div>'\r\n\t\t\t+ '<h2>' + t('files_sharing', 'No pending shares') + '</h2>'\r\n\t\t\t+ '<p>' + t('files_sharing', 'Shares you have received but not confirmed will show up here') + '</p>')\r\n\t\treturn this._pendingFileList\r\n\t},\r\n\r\n\tinitShareingOverview($el) {\r\n\t\tif (this._overviewFileList) {\r\n\t\t\treturn this._overviewFileList\r\n\t\t}\r\n\t\tthis._overviewFileList = new OCA.Sharing.FileList(\r\n\t\t\t$el,\r\n\t\t\t{\r\n\t\t\t\tid: 'shares.overview',\r\n\t\t\t\tfileActions: this._createFileActions(),\r\n\t\t\t\tconfig: OCA.Files.App.getFilesConfig(),\r\n\t\t\t\tisOverview: true,\r\n\t\t\t\t// The file list is created when a \"show\" event is handled, so\r\n\t\t\t\t// it should be marked as \"shown\" like it would have been done\r\n\t\t\t\t// if handling the event with the file list already created.\r\n\t\t\t\tshown: true,\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\tthis._extendFileList(this._overviewFileList)\r\n\t\tthis._overviewFileList.appName = t('files_sharing', 'Shares')\r\n\t\tthis._overviewFileList.$el.find('.emptyfilelist.emptycontent').html('<div class=\"icon-share\"></div>'\r\n\t\t\t+ '<h2>' + t('files_sharing', 'No shares') + '</h2>'\r\n\t\t\t+ '<p>' + t('files_sharing', 'Shares will show up here') + '</p>')\r\n\t\treturn this._overviewFileList\r\n\t},\r\n\r\n\tremoveSharingIn() {\r\n\t\tif (this._inFileList) {\r\n\t\t\tthis._inFileList.$fileList.empty()\r\n\t\t}\r\n\t},\r\n\r\n\tremoveSharingOut() {\r\n\t\tif (this._outFileList) {\r\n\t\t\tthis._outFileList.$fileList.empty()\r\n\t\t}\r\n\t},\r\n\r\n\tremoveSharingLinks() {\r\n\t\tif (this._linkFileList) {\r\n\t\t\tthis._linkFileList.$fileList.empty()\r\n\t\t}\r\n\t},\r\n\r\n\tremoveSharingDeleted() {\r\n\t\tif (this._deletedFileList) {\r\n\t\t\tthis._deletedFileList.$fileList.empty()\r\n\t\t}\r\n\t},\r\n\r\n\tremoveSharingPending() {\r\n\t\tif (this._pendingFileList) {\r\n\t\t\tthis._pendingFileList.$fileList.empty()\r\n\t\t}\r\n\t},\r\n\r\n\tremoveSharingOverview() {\r\n\t\tif (this._overviewFileList) {\r\n\t\t\tthis._overviewFileList.$fileList.empty()\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Destroy the app\r\n\t */\r\n\tdestroy() {\r\n\t\tOCA.Files.fileActions.off('setDefault.app-sharing', this._onActionsUpdated)\r\n\t\tOCA.Files.fileActions.off('registerAction.app-sharing', this._onActionsUpdated)\r\n\t\tthis.removeSharingIn()\r\n\t\tthis.removeSharingOut()\r\n\t\tthis.removeSharingLinks()\r\n\t\tthis._inFileList = null\r\n\t\tthis._outFileList = null\r\n\t\tthis._linkFileList = null\r\n\t\tthis._overviewFileList = null\r\n\t\tdelete this._globalActionsInitialized\r\n\t},\r\n\r\n\t_createFileActions() {\r\n\t\t// inherit file actions from the files app\r\n\t\tconst fileActions = new OCA.Files.FileActions()\r\n\t\t// note: not merging the legacy actions because legacy apps are not\r\n\t\t// compatible with the sharing overview and need to be adapted first\r\n\t\tfileActions.registerDefaultActions()\r\n\t\tfileActions.merge(OCA.Files.fileActions)\r\n\r\n\t\tif (!this._globalActionsInitialized) {\r\n\t\t\t// in case actions are registered later\r\n\t\t\tthis._onActionsUpdated = _.bind(this._onActionsUpdated, this)\r\n\t\t\tOCA.Files.fileActions.on('setDefault.app-sharing', this._onActionsUpdated)\r\n\t\t\tOCA.Files.fileActions.on('registerAction.app-sharing', this._onActionsUpdated)\r\n\t\t\tthis._globalActionsInitialized = true\r\n\t\t}\r\n\r\n\t\t// when the user clicks on a folder, redirect to the corresponding\r\n\t\t// folder in the files app instead of opening it directly\r\n\t\tfileActions.register('dir', 'Open', OC.PERMISSION_READ, '', function(filename, context) {\r\n\t\t\tOCA.Files.App.setActiveView('files', { silent: true })\r\n\t\t\tOCA.Files.App.fileList.changeDirectory(OC.joinPaths(context.$file.attr('data-path'), filename), true, true)\r\n\t\t})\r\n\t\tfileActions.setDefault('dir', 'Open')\r\n\t\treturn fileActions\r\n\t},\r\n\r\n\t_restoreShareAction() {\r\n\t\tconst fileActions = new OCA.Files.FileActions()\r\n\t\tfileActions.registerAction({\r\n\t\t\tname: 'Restore',\r\n\t\t\tdisplayName: t('files_sharing', 'Restore'),\r\n\t\t\taltText: t('files_sharing', 'Restore share'),\r\n\t\t\tmime: 'all',\r\n\t\t\tpermissions: OC.PERMISSION_ALL,\r\n\t\t\ticonClass: 'icon-history',\r\n\t\t\ttype: OCA.Files.FileActions.TYPE_INLINE,\r\n\t\t\tactionHandler(fileName, context) {\r\n\t\t\t\tconst shareId = context.$file.data('shareId')\r\n\t\t\t\t$.post(OC.linkToOCS('apps/files_sharing/api/v1/deletedshares', 2) + shareId)\r\n\t\t\t\t\t.success(function(result) {\r\n\t\t\t\t\t\tcontext.fileList.remove(context.fileInfoModel.attributes.name)\r\n\t\t\t\t\t}).fail(function() {\r\n\t\t\t\t\t\tOC.Notification.showTemporary(t('files_sharing', 'Something happened. Unable to restore the share.'))\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t})\r\n\t\treturn fileActions\r\n\t},\r\n\r\n\t_acceptShareAction() {\r\n\t\tconst fileActions = new OCA.Files.FileActions()\r\n\t\tfileActions.registerAction({\r\n\t\t\tname: 'Accept share',\r\n\t\t\tdisplayName: t('files_sharing', 'Accept share'),\r\n\t\t\tmime: 'all',\r\n\t\t\tpermissions: OC.PERMISSION_ALL,\r\n\t\t\ticonClass: 'icon-checkmark',\r\n\t\t\ttype: OCA.Files.FileActions.TYPE_INLINE,\r\n\t\t\tactionHandler(fileName, context) {\r\n\t\t\t\tconst shareId = context.$file.data('shareId')\r\n\t\t\t\tlet shareBase = 'shares/pending'\r\n\t\t\t\tif (context.$file.attr('data-remote-id')) {\r\n\t\t\t\t\tshareBase = 'remote_shares/pending'\r\n\t\t\t\t}\r\n\t\t\t\t$.post(OC.linkToOCS('apps/files_sharing/api/v1/' + shareBase, 2) + shareId)\r\n\t\t\t\t\t.success(function(result) {\r\n\t\t\t\t\t\tcontext.fileList.remove(context.fileInfoModel.attributes.name)\r\n\t\t\t\t\t}).fail(function() {\r\n\t\t\t\t\t\tOC.Notification.showTemporary(t('files_sharing', 'Something happened. Unable to accept the share.'))\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t})\r\n\t\tfileActions.registerAction({\r\n\t\t\tname: 'Reject share',\r\n\t\t\tdisplayName: t('files_sharing', 'Reject share'),\r\n\t\t\tmime: 'all',\r\n\t\t\tpermissions: OC.PERMISSION_ALL,\r\n\t\t\ticonClass: 'icon-close',\r\n\t\t\ttype: OCA.Files.FileActions.TYPE_INLINE,\r\n\t\t\tshouldRender(context) {\r\n\t\t\t\t// disable rejecting group shares from the pending list because they anyway\r\n\t\t\t\t// land back into that same list\r\n\t\t\t\tif (context.$file.attr('data-remote-id') && parseInt(context.$file.attr('data-share-type'), 10) === OC.Share.SHARE_TYPE_REMOTE_GROUP) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\treturn true\r\n\t\t\t},\r\n\t\t\tactionHandler(fileName, context) {\r\n\t\t\t\tconst shareId = context.$file.data('shareId')\r\n\t\t\t\tlet shareBase = 'shares'\r\n\t\t\t\tif (context.$file.attr('data-remote-id')) {\r\n\t\t\t\t\tshareBase = 'remote_shares'\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: OC.linkToOCS('apps/files_sharing/api/v1/' + shareBase, 2) + shareId,\r\n\t\t\t\t\ttype: 'DELETE',\r\n\t\t\t\t}).success(function(result) {\r\n\t\t\t\t\tcontext.fileList.remove(context.fileInfoModel.attributes.name)\r\n\t\t\t\t}).fail(function() {\r\n\t\t\t\t\tOC.Notification.showTemporary(t('files_sharing', 'Something happened. Unable to reject the share.'))\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t})\r\n\t\treturn fileActions\r\n\t},\r\n\r\n\t_onActionsUpdated(ev) {\r\n\t\t_.each([this._inFileList, this._outFileList, this._linkFileList], function(list) {\r\n\t\t\tif (!list) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tif (ev.action) {\r\n\t\t\t\tlist.fileActions.registerAction(ev.action)\r\n\t\t\t} else if (ev.defaultAction) {\r\n\t\t\t\tlist.fileActions.setDefault(\r\n\t\t\t\t\tev.defaultAction.mime,\r\n\t\t\t\t\tev.defaultAction.name\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t})\r\n\t},\r\n\r\n\t_extendFileList(fileList) {\r\n\t\t// remove size column from summary\r\n\t\tfileList.fileSummary.$el.find('.filesize').remove()\r\n\t},\r\n}\r\n\r\nwindow.addEventListener('DOMContentLoaded', function() {\r\n\t$('#app-content-sharingin').on('show', function(e) {\r\n\t\tOCA.Sharing.App.initSharingIn($(e.target))\r\n\t})\r\n\t$('#app-content-sharingin').on('hide', function() {\r\n\t\tOCA.Sharing.App.removeSharingIn()\r\n\t})\r\n\t$('#app-content-sharingout').on('show', function(e) {\r\n\t\tOCA.Sharing.App.initSharingOut($(e.target))\r\n\t})\r\n\t$('#app-content-sharingout').on('hide', function() {\r\n\t\tOCA.Sharing.App.removeSharingOut()\r\n\t})\r\n\t$('#app-content-sharinglinks').on('show', function(e) {\r\n\t\tOCA.Sharing.App.initSharingLinks($(e.target))\r\n\t})\r\n\t$('#app-content-sharinglinks').on('hide', function() {\r\n\t\tOCA.Sharing.App.removeSharingLinks()\r\n\t})\r\n\t$('#app-content-deletedshares').on('show', function(e) {\r\n\t\tOCA.Sharing.App.initSharingDeleted($(e.target))\r\n\t})\r\n\t$('#app-content-deletedshares').on('hide', function() {\r\n\t\tOCA.Sharing.App.removeSharingDeleted()\r\n\t})\r\n\t$('#app-content-pendingshares').on('show', function(e) {\r\n\t\tOCA.Sharing.App.initSharingPening($(e.target))\r\n\t})\r\n\t$('#app-content-pendingshares').on('hide', function() {\r\n\t\tOCA.Sharing.App.removeSharingPending()\r\n\t})\r\n\t$('#app-content-shareoverview').on('show', function(e) {\r\n\t\tOCA.Sharing.App.initShareingOverview($(e.target))\r\n\t})\r\n\t$('#app-content-shareoverview').on('hide', function() {\r\n\t\tOCA.Sharing.App.removeSharingOverview()\r\n\t})\r\n})\r\n","/* eslint-disable */\r\n/*\r\n * Copyright (c) 2014 Vincent Petry <pvince81@owncloud.com>\r\n *\r\n * This file is licensed under the Affero General Public License version 3\r\n * or later.\r\n *\r\n * See the COPYING-README file.\r\n *\r\n */\r\n(function() {\r\n\r\n\t/**\r\n\t * @class OCA.Sharing.FileList\r\n\t * @augments OCA.Files.FileList\r\n\t *\r\n\t * @classdesc Sharing file list.\r\n\t * Contains both \"shared with others\" and \"shared with you\" modes.\r\n\t *\r\n\t * @param $el container element with existing markup for the .files-controls\r\n\t * and a table\r\n\t * @param [options] map of options, see other parameters\r\n\t * @param {boolean} [options.sharedWithUser] true to return files shared with\r\n\t * the current user, false to return files that the user shared with others.\r\n\t * Defaults to false.\r\n\t * @param {boolean} [options.linksOnly] true to return only link shares\r\n\t */\r\n\tvar FileList = function($el, options) {\r\n\t\tthis.initialize($el, options)\r\n\t}\r\n\tFileList.prototype = _.extend({}, OCA.Files.FileList.prototype,\r\n\t\t/** @lends OCA.Sharing.FileList.prototype */ {\r\n\t\t\tappName: 'Shares',\r\n\r\n\t\t\t/**\r\n\t\t * Whether the list shows the files shared with the user (true) or\r\n\t\t * the files that the user shared with others (false).\r\n\t\t */\r\n\t\t\t_sharedWithUser: false,\r\n\t\t\t_linksOnly: false,\r\n\t\t\t_showDeleted: false,\r\n\t\t\t_showPending: false,\r\n\t\t\t_clientSideSort: true,\r\n\t\t\t_allowSelection: false,\r\n\t\t\t_isOverview: false,\r\n\r\n\t\t\t/**\r\n\t\t * @private\r\n\t\t */\r\n\t\t\tinitialize: function($el, options) {\r\n\t\t\t\tOCA.Files.FileList.prototype.initialize.apply(this, arguments)\r\n\t\t\t\tif (this.initialized) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// TODO: consolidate both options\r\n\t\t\t\tif (options && options.sharedWithUser) {\r\n\t\t\t\t\tthis._sharedWithUser = true\r\n\t\t\t\t}\r\n\t\t\t\tif (options && options.linksOnly) {\r\n\t\t\t\t\tthis._linksOnly = true\r\n\t\t\t\t}\r\n\t\t\t\tif (options && options.showDeleted) {\r\n\t\t\t\t\tthis._showDeleted = true\r\n\t\t\t\t}\r\n\t\t\t\tif (options && options.showPending) {\r\n\t\t\t\t\tthis._showPending = true\r\n\t\t\t\t}\r\n\t\t\t\tif (options && options.isOverview) {\r\n\t\t\t\t\tthis._isOverview = true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t_renderRow: function() {\r\n\t\t\t// HACK: needed to call the overridden _renderRow\r\n\t\t\t// this is because at the time this class is created\r\n\t\t\t// the overriding hasn't been done yet...\r\n\t\t\t\treturn OCA.Files.FileList.prototype._renderRow.apply(this, arguments)\r\n\t\t\t},\r\n\r\n\t\t\t_createRow: function(fileData) {\r\n\t\t\t// TODO: hook earlier and render the whole row here\r\n\t\t\t\tvar $tr = OCA.Files.FileList.prototype._createRow.apply(this, arguments)\r\n\t\t\t\t$tr.find('.filesize').remove()\r\n\t\t\t\t$tr.find('td.date').before($tr.children('td:first'))\r\n\t\t\t\t$tr.find('td.filename input:checkbox').remove()\r\n\t\t\t\t$tr.attr('data-share-id', _.pluck(fileData.shares, 'id').join(','))\r\n\t\t\t\tif (this._sharedWithUser) {\r\n\t\t\t\t\t$tr.attr('data-share-owner', fileData.shareOwner)\r\n\t\t\t\t\t$tr.attr('data-mounttype', 'shared-root')\r\n\t\t\t\t\tvar permission = parseInt($tr.attr('data-permissions')) | OC.PERMISSION_DELETE\r\n\t\t\t\t\t$tr.attr('data-permissions', permission)\r\n\t\t\t\t}\r\n\t\t\t\tif (this._showDeleted || this._showPending) {\r\n\t\t\t\t\tvar permission = fileData.permissions\r\n\t\t\t\t\t$tr.attr('data-share-permissions', permission)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (fileData.remoteId) {\r\n\t\t\t\t\t$tr.attr('data-remote-id', fileData.remoteId)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (fileData.shareType) {\r\n\t\t\t\t\t$tr.attr('data-share-type', fileData.shareType)\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// add row with expiration date for link only shares - influenced by _createRow of filelist\r\n\t\t\t\tif (this._linksOnly) {\r\n\t\t\t\t\tvar expirationTimestamp = 0\r\n\t\t\t\t\tif (fileData.shares && fileData.shares[0].expiration !== null) {\r\n\t\t\t\t\t\texpirationTimestamp = moment(fileData.shares[0].expiration).valueOf()\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$tr.attr('data-expiration', expirationTimestamp)\r\n\r\n\t\t\t\t\t// date column (1000 milliseconds to seconds, 60 seconds, 60 minutes, 24 hours)\r\n\t\t\t\t\t// difference in days multiplied by 5 - brightest shade for expiry dates in more than 32 days (160/5)\r\n\t\t\t\t\tvar modifiedColor = Math.round((expirationTimestamp - (new Date()).getTime()) / 1000 / 60 / 60 / 24 * 5)\r\n\t\t\t\t\t// ensure that the brightest color is still readable\r\n\t\t\t\t\tif (modifiedColor >= 160) {\r\n\t\t\t\t\t\tmodifiedColor = 160\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar formatted\r\n\t\t\t\t\tvar text\r\n\t\t\t\t\tif (expirationTimestamp > 0) {\r\n\t\t\t\t\t\tformatted = OC.Util.formatDate(expirationTimestamp)\r\n\t\t\t\t\t\ttext = OC.Util.relativeModifiedDate(expirationTimestamp)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tformatted = t('files_sharing', 'No expiration date set')\r\n\t\t\t\t\t\ttext = ''\r\n\t\t\t\t\t\tmodifiedColor = 160\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttd = $('<td></td>').attr({ 'class': 'date' })\r\n\t\t\t\t\ttd.append($('<span></span>').attr({\r\n\t\t\t\t\t\t'class': 'modified',\r\n\t\t\t\t\t\t'title': formatted,\r\n\t\t\t\t\t\t'style': 'color:rgb(' + modifiedColor + ',' + modifiedColor + ',' + modifiedColor + ')'\r\n\t\t\t\t\t}).text(text)\r\n\t\t\t\t\t\t.tooltip({ placement: 'top' })\r\n\t\t\t\t\t)\r\n\r\n\t\t\t\t\t$tr.append(td)\r\n\t\t\t\t}\r\n\t\t\t\treturn $tr\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t * Set whether the list should contain outgoing shares\r\n\t\t * or incoming shares.\r\n\t\t *\r\n\t\t * @param state true for incoming shares, false otherwise\r\n\t\t */\r\n\t\t\tsetSharedWithUser: function(state) {\r\n\t\t\t\tthis._sharedWithUser = !!state\r\n\t\t\t},\r\n\r\n\t\t\tupdateEmptyContent: function() {\r\n\t\t\t\tvar dir = this.getCurrentDirectory()\r\n\t\t\t\tif (dir === '/') {\r\n\t\t\t\t// root has special permissions\r\n\t\t\t\t\tthis.$el.find('.emptyfilelist.emptycontent').toggleClass('hidden', !this.isEmpty)\r\n\t\t\t\t\tthis.$el.find('.files-filestable thead th').toggleClass('hidden', this.isEmpty)\r\n\r\n\t\t\t\t\t// hide expiration date header for non link only shares\r\n\t\t\t\t\tif (!this._linksOnly) {\r\n\t\t\t\t\t\tthis.$el.find('th.column-expiration').addClass('hidden')\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tOCA.Files.FileList.prototype.updateEmptyContent.apply(this, arguments)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgetDirectoryPermissions: function() {\r\n\t\t\t\treturn OC.PERMISSION_READ | OC.PERMISSION_DELETE\r\n\t\t\t},\r\n\r\n\t\t\tupdateStorageStatistics: function() {\r\n\t\t\t// no op because it doesn't have\r\n\t\t\t// storage info like free space / used space\r\n\t\t\t},\r\n\r\n\t\t\treload: function() {\r\n\t\t\t\tthis.showMask()\r\n\t\t\t\tif (this._reloadCall) {\r\n\t\t\t\t\tthis._reloadCall.abort()\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// there is only root\r\n\t\t\t\tthis._setCurrentDir('/', false)\r\n\r\n\t\t\t\tvar promises = []\r\n\r\n\t\t\t\tvar deletedShares = {\r\n\t\t\t\t\turl: OC.linkToOCS('apps/files_sharing/api/v1', 2) + 'deletedshares',\r\n\t\t\t\t\t/* jshint camelcase: false */\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tformat: 'json',\r\n\t\t\t\t\t\tinclude_tags: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttype: 'GET',\r\n\t\t\t\t\tbeforeSend: function(xhr) {\r\n\t\t\t\t\t\txhr.setRequestHeader('OCS-APIREQUEST', 'true')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar pendingShares = {\r\n\t\t\t\t\turl: OC.linkToOCS('apps/files_sharing/api/v1/shares', 2) + 'pending',\r\n\t\t\t\t\t/* jshint camelcase: false */\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tformat: 'json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttype: 'GET',\r\n\t\t\t\t\tbeforeSend: function(xhr) {\r\n\t\t\t\t\t\txhr.setRequestHeader('OCS-APIREQUEST', 'true')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar pendingRemoteShares = {\r\n\t\t\t\t\turl: OC.linkToOCS('apps/files_sharing/api/v1/remote_shares', 2) + 'pending',\r\n\t\t\t\t\t/* jshint camelcase: false */\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tformat: 'json'\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttype: 'GET',\r\n\t\t\t\t\tbeforeSend: function(xhr) {\r\n\t\t\t\t\t\txhr.setRequestHeader('OCS-APIREQUEST', 'true')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar shares = {\r\n\t\t\t\t\turl: OC.linkToOCS('apps/files_sharing/api/v1') + 'shares',\r\n\t\t\t\t\t/* jshint camelcase: false */\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tformat: 'json',\r\n\t\t\t\t\t\tshared_with_me: this._sharedWithUser !== false,\r\n\t\t\t\t\t\tinclude_tags: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttype: 'GET',\r\n\t\t\t\t\tbeforeSend: function(xhr) {\r\n\t\t\t\t\t\txhr.setRequestHeader('OCS-APIREQUEST', 'true')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar remoteShares = {\r\n\t\t\t\t\turl: OC.linkToOCS('apps/files_sharing/api/v1') + 'remote_shares',\r\n\t\t\t\t\t/* jshint camelcase: false */\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tformat: 'json',\r\n\t\t\t\t\t\tinclude_tags: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttype: 'GET',\r\n\t\t\t\t\tbeforeSend: function(xhr) {\r\n\t\t\t\t\t\txhr.setRequestHeader('OCS-APIREQUEST', 'true')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Add the proper ajax requests to the list and run them\r\n\t\t\t\t// and make sure we have 2 promises\r\n\t\t\t\tif (this._showDeleted) {\r\n\t\t\t\t\tpromises.push($.ajax(deletedShares))\r\n\t\t\t\t} else if (this._showPending) {\r\n\t\t\t\t\tpromises.push($.ajax(pendingShares))\r\n\t\t\t\t\tpromises.push($.ajax(pendingRemoteShares))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpromises.push($.ajax(shares))\r\n\r\n\t\t\t\t\tif (this._sharedWithUser !== false || this._isOverview) {\r\n\t\t\t\t\t\tpromises.push($.ajax(remoteShares))\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this._isOverview) {\r\n\t\t\t\t\t\tshares.data.shared_with_me = !shares.data.shared_with_me\r\n\t\t\t\t\t\tpromises.push($.ajax(shares))\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._reloadCall = $.when.apply($, promises)\r\n\t\t\t\tvar callBack = this.reloadCallback.bind(this)\r\n\t\t\t\treturn this._reloadCall.then(callBack, callBack)\r\n\t\t\t},\r\n\r\n\t\t\treloadCallback: function(shares, remoteShares, additionalShares) {\r\n\t\t\t\tdelete this._reloadCall\r\n\t\t\t\tthis.hideMask()\r\n\r\n\t\t\t\tthis.$el.find('#headerSharedWith').text(\r\n\t\t\t\t\tt('files_sharing', this._sharedWithUser ? 'Shared by' : 'Shared with')\r\n\t\t\t\t)\r\n\r\n\t\t\t\tvar files = []\r\n\r\n\t\t\t\t// make sure to use the same format\r\n\t\t\t\tif (shares[0] && shares[0].ocs) {\r\n\t\t\t\t\tshares = shares[0]\r\n\t\t\t\t}\r\n\t\t\t\tif (remoteShares && remoteShares[0] && remoteShares[0].ocs) {\r\n\t\t\t\t\tremoteShares = remoteShares[0]\r\n\t\t\t\t}\r\n\t\t\t\tif (additionalShares && additionalShares[0] && additionalShares[0].ocs) {\r\n\t\t\t\t\tadditionalShares = additionalShares[0]\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (shares.ocs && shares.ocs.data) {\r\n\t\t\t\t\tfiles = files.concat(this._makeFilesFromShares(shares.ocs.data, this._sharedWithUser))\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (remoteShares && remoteShares.ocs && remoteShares.ocs.data) {\r\n\t\t\t\t\tfiles = files.concat(this._makeFilesFromRemoteShares(remoteShares.ocs.data))\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (additionalShares && additionalShares.ocs && additionalShares.ocs.data) {\r\n\t\t\t\t\tif (this._showPending) {\r\n\t\t\t\t\t\t// in this case the second callback is about pending remote shares\r\n\t\t\t\t\t\tfiles = files.concat(this._makeFilesFromRemoteShares(additionalShares.ocs.data))\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tfiles = files.concat(this._makeFilesFromShares(additionalShares.ocs.data, !this._sharedWithUser))\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.setFiles(files)\r\n\t\t\t\treturn true\r\n\t\t\t},\r\n\r\n\t\t\t_makeFilesFromRemoteShares: function(data) {\r\n\t\t\t\tvar files = data\r\n\r\n\t\t\t\tfiles = _.chain(files)\r\n\t\t\t\t// convert share data to file data\r\n\t\t\t\t\t.map(function(share) {\r\n\t\t\t\t\t\tvar file = {\r\n\t\t\t\t\t\t\tshareOwner: share.owner + '@' + share.remote.replace(/.*?:\\/\\//g, ''),\r\n\t\t\t\t\t\t\tname: OC.basename(share.mountpoint),\r\n\t\t\t\t\t\t\tmtime: share.mtime * 1000,\r\n\t\t\t\t\t\t\tmimetype: share.mimetype,\r\n\t\t\t\t\t\t\ttype: share.type,\r\n\t\t\t\t\t\t\t// remote share types are different and need to be mapped\r\n\t\t\t\t\t\t\tshareType: (parseInt(share.share_type, 10) === 1) ? OC.Share.SHARE_TYPE_REMOTE_GROUP : OC.Share.SHARE_TYPE_REMOTE,\r\n\t\t\t\t\t\t\tid: share.file_id,\r\n\t\t\t\t\t\t\tpath: OC.dirname(share.mountpoint),\r\n\t\t\t\t\t\t\tpermissions: share.permissions,\r\n\t\t\t\t\t\t\ttags: share.tags || []\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (share.remote_id) {\r\n\t\t\t\t\t\t\t// remote share\r\n\t\t\t\t\t\t\tif (share.accepted !== '1') {\r\n\t\t\t\t\t\t\t\tfile.name = OC.basename(share.name)\r\n\t\t\t\t\t\t\t\tfile.path = '/'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfile.remoteId = share.remote_id\r\n\t\t\t\t\t\t\tfile.shareOwnerId = share.owner\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!file.mimetype) {\r\n\t\t\t\t\t\t\t// pending shares usually have no type, so default to showing a directory icon\r\n\t\t\t\t\t\t\tfile.mimetype = 'dir-shared'\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfile.shares = [{\r\n\t\t\t\t\t\t\tid: share.id,\r\n\t\t\t\t\t\t\ttype: OC.Share.SHARE_TYPE_REMOTE\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t\treturn file\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.value()\r\n\t\t\t\treturn files\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t * Converts the OCS API share response data to a file info\r\n\t\t * list\r\n\t\t * @param {Array} data OCS API share array\r\n\t\t * @param {boolean} sharedWithUser\r\n\t\t * @returns {Array.<OCA.Sharing.SharedFileInfo>} array of shared file info\r\n\t\t */\r\n\t\t\t_makeFilesFromShares: function(data, sharedWithUser) {\r\n\t\t\t/* jshint camelcase: false */\r\n\t\t\t\tvar files = data\r\n\r\n\t\t\t\tif (this._linksOnly) {\r\n\t\t\t\t\tfiles = _.filter(data, function(share) {\r\n\t\t\t\t\t\treturn share.share_type === OC.Share.SHARE_TYPE_LINK\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// OCS API uses non-camelcased names\r\n\t\t\t\tfiles = _.chain(files)\r\n\t\t\t\t// convert share data to file data\r\n\t\t\t\t\t.map(function(share) {\r\n\t\t\t\t\t// TODO: use OC.Files.FileInfo\r\n\t\t\t\t\t\tvar file = {\r\n\t\t\t\t\t\t\tid: share.file_source,\r\n\t\t\t\t\t\t\ticon: OC.MimeType.getIconUrl(share.mimetype),\r\n\t\t\t\t\t\t\tmimetype: share.mimetype,\r\n\t\t\t\t\t\t\thasPreview: share.has_preview,\r\n\t\t\t\t\t\t\ttags: share.tags || []\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (share.item_type === 'folder') {\r\n\t\t\t\t\t\t\tfile.type = 'dir'\r\n\t\t\t\t\t\t\tfile.mimetype = 'httpd/unix-directory'\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tfile.type = 'file'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfile.share = {\r\n\t\t\t\t\t\t\tid: share.id,\r\n\t\t\t\t\t\t\ttype: share.share_type,\r\n\t\t\t\t\t\t\ttarget: share.share_with,\r\n\t\t\t\t\t\t\tstime: share.stime * 1000,\r\n\t\t\t\t\t\t\texpiration: share.expiration\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (sharedWithUser) {\r\n\t\t\t\t\t\t\tfile.shareOwner = share.displayname_owner\r\n\t\t\t\t\t\t\tfile.shareOwnerId = share.uid_owner\r\n\t\t\t\t\t\t\tfile.name = OC.basename(share.file_target)\r\n\t\t\t\t\t\t\tfile.path = OC.dirname(share.file_target)\r\n\t\t\t\t\t\t\tfile.permissions = share.permissions\r\n\t\t\t\t\t\t\tif (file.path) {\r\n\t\t\t\t\t\t\t\tfile.extraData = share.file_target\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (share.share_type !== OC.Share.SHARE_TYPE_LINK) {\r\n\t\t\t\t\t\t\t\tfile.share.targetDisplayName = share.share_with_displayname\r\n\t\t\t\t\t\t\t\tfile.share.targetShareWithId = share.share_with\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfile.name = OC.basename(share.path)\r\n\t\t\t\t\t\t\tfile.path = OC.dirname(share.path)\r\n\t\t\t\t\t\t\tfile.permissions = OC.PERMISSION_ALL\r\n\t\t\t\t\t\t\tif (file.path) {\r\n\t\t\t\t\t\t\t\tfile.extraData = share.path\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn file\r\n\t\t\t\t\t})\r\n\t\t\t\t// Group all files and have a \"shares\" array with\r\n\t\t\t\t// the share info for each file.\r\n\t\t\t\t//\r\n\t\t\t\t// This uses a hash memo to cumulate share information\r\n\t\t\t\t// inside the same file object (by file id).\r\n\t\t\t\t\t.reduce(function(memo, file) {\r\n\t\t\t\t\t\tvar data = memo[file.id]\r\n\t\t\t\t\t\tvar recipient = file.share.targetDisplayName\r\n\t\t\t\t\t\tvar recipientId = file.share.targetShareWithId\r\n\t\t\t\t\t\tif (!data) {\r\n\t\t\t\t\t\t\tdata = memo[file.id] = file\r\n\t\t\t\t\t\t\tdata.shares = [file.share]\r\n\t\t\t\t\t\t\t// using a hash to make them unique,\r\n\t\t\t\t\t\t\t// this is only a list to be displayed\r\n\t\t\t\t\t\t\tdata.recipients = {}\r\n\t\t\t\t\t\t\tdata.recipientData = {}\r\n\t\t\t\t\t\t\t// share types\r\n\t\t\t\t\t\t\tdata.shareTypes = {}\r\n\t\t\t\t\t\t\t// counter is cheaper than calling _.keys().length\r\n\t\t\t\t\t\t\tdata.recipientsCount = 0\r\n\t\t\t\t\t\t\tdata.mtime = file.share.stime\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// always take the most recent stime\r\n\t\t\t\t\t\t\tif (file.share.stime > data.mtime) {\r\n\t\t\t\t\t\t\t\tdata.mtime = file.share.stime\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdata.shares.push(file.share)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (recipient) {\r\n\t\t\t\t\t\t// limit counterparts for output\r\n\t\t\t\t\t\t\tif (data.recipientsCount < 4) {\r\n\t\t\t\t\t\t\t// only store the first ones, they will be the only ones\r\n\t\t\t\t\t\t\t// displayed\r\n\t\t\t\t\t\t\t\tdata.recipients[recipient] = true\r\n\t\t\t\t\t\t\t\tdata.recipientData[data.recipientsCount] = {\r\n\t\t\t\t\t\t\t\t\t'shareWith': recipientId,\r\n\t\t\t\t\t\t\t\t\t'shareWithDisplayName': recipient\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdata.recipientsCount++\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdata.shareTypes[file.share.type] = true\r\n\r\n\t\t\t\t\t\tdelete file.share\r\n\t\t\t\t\t\treturn memo\r\n\t\t\t\t\t}, {})\r\n\t\t\t\t// Retrieve only the values of the returned hash\r\n\t\t\t\t\t.values()\r\n\t\t\t\t// Clean up\r\n\t\t\t\t\t.each(function(data) {\r\n\t\t\t\t\t// convert the recipients map to a flat\r\n\t\t\t\t\t// array of sorted names\r\n\t\t\t\t\t\tdata.mountType = 'shared'\r\n\t\t\t\t\t\tdelete data.recipientsCount\r\n\t\t\t\t\t\tif (sharedWithUser) {\r\n\t\t\t\t\t\t// only for outgoing shares\r\n\t\t\t\t\t\t\tdelete data.shareTypes\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdata.shareTypes = _.keys(data.shareTypes)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t// Finish the chain by getting the result\r\n\t\t\t\t\t.value()\r\n\r\n\t\t\t\t// Sort by expected sort comparator\r\n\t\t\t\treturn files.sort(this._sortComparator)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t/**\r\n\t * Share info attributes.\r\n\t *\r\n\t * @typedef {Object} OCA.Sharing.ShareInfo\r\n\t *\r\n\t * @property {number} id share ID\r\n\t * @property {number} type share type\r\n\t * @property {String} target share target, either user name or group name\r\n\t * @property {number} stime share timestamp in milliseconds\r\n\t * @property {String} [targetDisplayName] display name of the recipient\r\n\t * (only when shared with others)\r\n\t * @property {String} [targetShareWithId] id of the recipient\r\n\t *\r\n\t */\r\n\r\n\t/**\r\n\t * Recipient attributes\r\n\t *\r\n\t * @typedef {Object} OCA.Sharing.RecipientInfo\r\n\t * @property {String} shareWith the id of the recipient\r\n\t * @property {String} shareWithDisplayName the display name of the recipient\r\n\t */\r\n\r\n\t/**\r\n\t * Shared file info attributes.\r\n\t *\r\n\t * @typedef {OCA.Files.FileInfo} OCA.Sharing.SharedFileInfo\r\n\t *\r\n\t * @property {Array.<OCA.Sharing.ShareInfo>} shares array of shares for\r\n\t * this file\r\n\t * @property {number} mtime most recent share time (if multiple shares)\r\n\t * @property {String} shareOwner name of the share owner\r\n\t * @property {Array.<String>} recipients name of the first 4 recipients\r\n\t * (this is mostly for display purposes)\r\n\t * @property {Object.<OCA.Sharing.RecipientInfo>} recipientData (as object for easier\r\n\t * passing to HTML data attributes with jQuery)\r\n\t */\r\n\r\n\tOCA.Sharing.FileList = FileList\r\n})()\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }"],"names":["OCA","Sharing","App","_inFileList","_outFileList","_overviewFileList","_pendingFileList","initSharingIn","$el","this","FileList","id","sharedWithUser","fileActions","_createFileActions","config","Files","getFilesConfig","shown","_extendFileList","appName","t","find","html","initSharingOut","initSharingLinks","_linkFileList","linksOnly","initSharingDeleted","_deletedFileList","defaultFileActionsDisabled","showDeleted","_restoreShareAction","initSharingPening","showPending","detailsViewEnabled","_acceptShareAction","initShareingOverview","isOverview","removeSharingIn","$fileList","empty","removeSharingOut","removeSharingLinks","removeSharingDeleted","removeSharingPending","removeSharingOverview","destroy","off","_onActionsUpdated","_globalActionsInitialized","FileActions","registerDefaultActions","merge","_","bind","on","register","OC","PERMISSION_READ","filename","context","setActiveView","silent","fileList","changeDirectory","joinPaths","$file","attr","setDefault","registerAction","name","displayName","altText","mime","permissions","PERMISSION_ALL","iconClass","type","TYPE_INLINE","actionHandler","fileName","shareId","data","$","post","linkToOCS","success","result","remove","fileInfoModel","attributes","fail","Notification","showTemporary","shareBase","shouldRender","parseInt","Share","SHARE_TYPE_REMOTE_GROUP","ajax","url","ev","each","list","action","defaultAction","fileSummary","window","addEventListener","e","target","options","initialize","prototype","extend","_sharedWithUser","_linksOnly","_showDeleted","_showPending","_clientSideSort","_allowSelection","_isOverview","apply","arguments","initialized","_renderRow","_createRow","fileData","$tr","before","children","pluck","shares","join","shareOwner","permission","PERMISSION_DELETE","remoteId","shareType","expirationTimestamp","expiration","moment","valueOf","formatted","text","modifiedColor","Math","round","Date","getTime","Util","formatDate","relativeModifiedDate","td","append","tooltip","placement","setSharedWithUser","state","updateEmptyContent","dir","getCurrentDirectory","toggleClass","isEmpty","addClass","getDirectoryPermissions","updateStorageStatistics","reload","showMask","_reloadCall","abort","_setCurrentDir","promises","deletedShares","format","include_tags","beforeSend","xhr","setRequestHeader","pendingShares","pendingRemoteShares","shared_with_me","remoteShares","push","when","callBack","reloadCallback","then","additionalShares","hideMask","files","ocs","concat","_makeFilesFromShares","_makeFilesFromRemoteShares","setFiles","chain","map","share","file","owner","remote","replace","basename","mountpoint","mtime","mimetype","share_type","SHARE_TYPE_REMOTE","file_id","path","dirname","tags","remote_id","accepted","shareOwnerId","value","filter","SHARE_TYPE_LINK","file_source","icon","MimeType","getIconUrl","hasPreview","has_preview","item_type","share_with","stime","displayname_owner","uid_owner","file_target","extraData","targetDisplayName","share_with_displayname","targetShareWithId","reduce","memo","recipient","recipientId","recipients","recipientData","shareTypes","recipientsCount","values","mountType","keys","sort","_sortComparator","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","hasOwnProperty","call"],"sourceRoot":""}