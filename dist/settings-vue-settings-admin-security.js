/*! For license information please see settings-vue-settings-admin-security.js.LICENSE.txt */
!function(){"use strict";var n,e={99989:function(n,e,r){var o=r(16453),s=r(20144),a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("NcSettingsSection",{attrs:{title:t.t("settings","Two-Factor Authentication"),description:t.t("settings","Two-factor authentication can be enforced for all users and specific groups. If they do not have a two-factor provider configured, they will be unable to log into the system."),"doc-url":t.twoFactorAdminDoc}},[t.loading?e("p",[e("span",{staticClass:"icon-loading-small two-factor-loading"}),t._v(" "),e("span",[t._v(t._s(t.t("settings","Enforce two-factor authentication")))])]):e("NcCheckboxRadioSwitch",{attrs:{id:"two-factor-enforced",checked:t.enforced,type:"switch"},on:{"update:checked":function(n){t.enforced=n}}},[t._v("\n\t\t"+t._s(t.t("settings","Enforce two-factor authentication"))+"\n\t")]),t._v(" "),t.enforced?[e("h3",[t._v(t._s(t.t("settings","Limit to groups")))]),t._v("\n\t\t"+t._s(t.t("settings","Enforcement of two-factor authentication can be set for certain groups only."))+"\n\t\t"),e("p",{staticClass:"top-margin"},[t._v("\n\t\t\t"+t._s(t.t("settings","Two-factor authentication is enforced for all members of the following groups."))+"\n\t\t")]),t._v(" "),e("p",[e("NcMultiselect",{attrs:{options:t.groups,placeholder:t.t("settings","Enforced groups"),disabled:t.loading,multiple:!0,searchable:!0,loading:t.loadingGroups,"show-no-options":!1,"close-on-select":!1},on:{"search-change":t.searchGroup},model:{value:t.enforcedGroups,callback:function(n){t.enforcedGroups=n},expression:"enforcedGroups"}})],1),t._v(" "),e("p",{staticClass:"top-margin"},[t._v("\n\t\t\t"+t._s(t.t("settings","Two-factor authentication is not enforced for members of the following groups."))+"\n\t\t")]),t._v(" "),e("p",[e("NcMultiselect",{attrs:{options:t.groups,placeholder:t.t("settings","Excluded groups"),disabled:t.loading,multiple:!0,searchable:!0,loading:t.loadingGroups,"show-no-options":!1,"close-on-select":!1},on:{"search-change":t.searchGroup},model:{value:t.excludedGroups,callback:function(n){t.excludedGroups=n},expression:"excludedGroups"}})],1),t._v(" "),e("p",{staticClass:"top-margin"},[e("em",[t._v("\n\t\t\t\t"+t._s(t.t("settings","When groups are selected/excluded, they use the following logic to determine if a user has 2FA enforced: If no groups are selected, 2FA is enabled for everyone except members of the excluded groups. If groups are selected, 2FA is enabled for all members of these. If a user is both in a selected and excluded group, the selected takes precedence and 2FA is enforced."))+"\n\t\t\t")])])]:t._e(),t._v(" "),e("p",{staticClass:"top-margin"},[t.dirty?e("NcButton",{attrs:{type:"primary",disabled:t.loading},on:{click:t.saveChanges}},[t._v("\n\t\t\t"+t._s(t.t("settings","Save changes"))+"\n\t\t")]):t._e()],1)],2)};a._withStripped=!0;var i=r(4820),c=r(98266),d=r.n(c),l=r(10861),u=r.n(l),p=r(20571),f=r.n(p),g=r(13299),h=r.n(g),m=r(96486),v=r.n(m),b=r(79753),y={name:"AdminTwoFactor",components:{NcMultiselect:d(),NcButton:u(),NcCheckboxRadioSwitch:f(),NcSettingsSection:h()},data:function(){return{loading:!1,dirty:!1,groups:[],loadingGroups:!1,twoFactorAdminDoc:(0,o.loadState)("settings","two-factor-admin-doc")}},computed:{enforced:{get:function(){return this.$store.state.enforced},set:function(t){this.dirty=!0,this.$store.commit("setEnforced",t)}},enforcedGroups:{get:function(){return this.$store.state.enforcedGroups},set:function(t){this.dirty=!0,this.$store.commit("setEnforcedGroups",t)}},excludedGroups:{get:function(){return this.$store.state.excludedGroups},set:function(t){this.dirty=!0,this.$store.commit("setExcludedGroups",t)}}},mounted:function(){this.groups=v().sortedUniq(v().uniq(this.enforcedGroups.concat(this.excludedGroups))),this.searchGroup("")},methods:{searchGroup:v().debounce((function(t){var n=this;this.loadingGroups=!0,i.default.get((0,b.generateOcsUrl)("cloud/groups?offset=0&search={query}&limit=20",{query:t})).then((function(t){return t.data.ocs})).then((function(t){return t.data.groups})).then((function(t){n.groups=v().sortedUniq(v().uniq(n.groups.concat(t)))})).catch((function(t){return console.error("could not search groups",t)})).then((function(){n.loadingGroups=!1}))}),500),saveChanges:function(){var t=this;this.loading=!0;var n={enforced:this.enforced,enforcedGroups:this.enforcedGroups,excludedGroups:this.excludedGroups};i.default.put((0,b.generateUrl)("/settings/api/admin/twofactorauth"),n).then((function(t){return t.data})).then((function(n){t.state=n,t.dirty=!1})).catch((function(t){console.error("could not save changes",t)})).then((function(){t.loading=!1}))}}},A=r(93379),w=r.n(A),C=r(7795),x=r.n(C),_=r(90569),k=r.n(_),G=r(3565),S=r.n(G),E=r(19216),N=r.n(E),R=r(44589),D=r.n(R),M=r(60964),O={};O.styleTagTransform=D(),O.setAttributes=S(),O.insert=k().bind(null,"head"),O.domAPI=x(),O.insertStyleElement=N(),w()(M.Z,O),M.Z&&M.Z.locals&&M.Z.locals;var T=r(51900),B=(0,T.Z)(y,a,[],!1,null,"20893fad",null);B.options.__file="apps/settings/src/components/AdminTwoFactor.vue";var P=B.exports,F=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("NcSettingsSection",{attrs:{title:t.t("settings","Server-side encryption"),description:t.t("settings","Server-side encryption makes it possible to encrypt files which are uploaded to this server. This comes with limitations like a performance penalty, so enable this only if needed."),"doc-url":t.encryptionAdminDoc}},[e("NcCheckboxRadioSwitch",{attrs:{checked:t.encryptionEnabled||t.shouldDisplayWarning,disabled:t.encryptionEnabled,type:"switch"},on:{"update:checked":t.displayWarning}},[t._v("\n\t\t"+t._s(t.t("settings","Enable server-side encryption"))+"\n\t")]),t._v(" "),t.shouldDisplayWarning&&!t.encryptionEnabled?e("div",{staticClass:"notecard warning",attrs:{role:"alert"}},[e("p",[t._v(t._s(t.t("settings","Please read carefully before activating server-side encryption:")))]),t._v(" "),e("ul",[e("li",[t._v(t._s(t.t("settings","Once encryption is enabled, all files uploaded to the server from that point forward will be encrypted at rest on the server. It will only be possible to disable encryption at a later date if the active encryption module supports that function, and all pre-conditions (e.g. setting a recover key) are met.")))]),t._v(" "),e("li",[t._v(t._s(t.t("settings","Encryption alone does not guarantee security of the system. Please see documentation for more information about how the encryption app works, and the supported use cases.")))]),t._v(" "),e("li",[t._v(t._s(t.t("settings","Be aware that encryption always increases the file size.")))]),t._v(" "),e("li",[t._v(t._s(t.t("settings","It is always good to create regular backups of your data, in case of encryption make sure to backup the encryption keys along with your data.")))])]),t._v(" "),e("p",{staticClass:"margin-bottom"},[t._v("\n\t\t\t"+t._s(t.t("settings","This is the final warning: Do you really want to enable encryption?"))+"\n\t\t")]),t._v(" "),e("NcButton",{attrs:{type:"primary"},on:{click:function(n){return t.enableEncryption()}}},[t._v("\n\t\t\t"+t._s(t.t("settings","Enable encryption"))+"\n\t\t")])],1):t._e(),t._v(" "),t.encryptionEnabled?e("div",[t.encryptionReady?e("div",[0===t.encryptionModules.length?e("p",[t._v("\n\t\t\t\t"+t._s(t.t("settings","No encryption module loaded, please enable an encryption module in the app menu."))+"\n\t\t\t")]):[e("h3",[t._v(t._s(t.t("settings","Select default encryption module:")))]),t._v(" "),e("fieldset",t._l(t.encryptionModules,(function(n,r){return e("NcCheckboxRadioSwitch",{key:r,attrs:{checked:t.defaultCheckedModule,value:r,type:"radio",name:"default_encryption_module"},on:{"update:checked":[function(n){t.defaultCheckedModule=n},t.checkDefaultModule]}},[t._v("\n\t\t\t\t\t\t"+t._s(n.displayName)+"\n\t\t\t\t\t")])})),1)]],2):t.externalBackendsEnabled?e("div",{domProps:{innerHTML:t._s(t.migrationMessage)}}):t._e()]):t._e()],1)};F._withStripped=!0;var Z=r(17499),I=r(10128),$=(r(65509),r(26932));function q(t,n,e,r,o,s,a){try{var i=t[s](a),c=i.value}catch(t){return void e(t)}i.done?n(c):Promise.resolve(c).then(r,o)}function U(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var s=t.apply(n,e);function a(t){q(s,r,o,a,i,"next",t)}function i(t){q(s,r,o,a,i,"throw",t)}a(void 0)}))}}var j=(0,Z.IY)().setApp("settings").detectUser().build(),W={name:"Encryption",components:{NcCheckboxRadioSwitch:f(),NcSettingsSection:h(),NcButton:u()},data:function(){var t=(0,o.loadState)("settings","encryption-modules");return{encryptionReady:(0,o.loadState)("settings","encryption-ready"),encryptionEnabled:(0,o.loadState)("settings","encryption-enabled"),externalBackendsEnabled:(0,o.loadState)("settings","external-backends-enabled"),encryptionAdminDoc:(0,o.loadState)("settings","encryption-admin-doc"),encryptionModules:t,shouldDisplayWarning:!1,migrating:!1,defaultCheckedModule:Object.entries(t).find((function(t){return t[1].default}))[0]}},computed:{migrationMessage:function(){return t("settings",'You need to migrate your encryption keys from the old encryption (ownCloud <= 8.0) to the new one. Please enable the "Default encryption module" and run {command}',{command:'"occ encryption:migrate"'})}},methods:{displayWarning:function(){this.encryptionEnabled?(this.encryptionEnabled=!1,this.shouldDisplayWarning=!1):this.shouldDisplayWarning=!this.shouldDisplayWarning},update:function(n,e){var r=this;return U(regeneratorRuntime.mark((function o(){var s,a,c,d,l,u;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,I.confirmPassword)();case 2:return s=(0,b.generateOcsUrl)("/apps/provisioning_api/api/v1/config/apps/{appId}/{key}",{appId:"core",key:n}),a=e?"yes":"no",o.prev=4,o.next=7,i.default.post(s,{value:a});case 7:l=o.sent,u=l.data,r.handleResponse({status:null===(c=u.ocs)||void 0===c||null===(d=c.meta)||void 0===d?void 0:d.status}),o.next=15;break;case 12:o.prev=12,o.t0=o.catch(4),r.handleResponse({errorMessage:t("settings","Unable to update server side encryption config"),error:o.t0});case 15:case"end":return o.stop()}}),o,null,[[4,12]])})))()},checkDefaultModule:function(){var t=this;return U(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.update("default_encryption_module",t.defaultCheckedModule);case 2:case"end":return n.stop()}}),n)})))()},enableEncryption:function(){var t=this;return U(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.encryptionEnabled=!0,n.next=3,t.update("encryption_enabled",!0);case 3:case"end":return n.stop()}}),n)})))()},handleResponse:function(t){return U(regeneratorRuntime.mark((function n(){var e,r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e=t.status,r=t.errorMessage,o=t.error,"ok"!==e&&((0,$.x2)(r),j.error(r,{error:o}));case 2:case"end":return n.stop()}}),n)})))()}}},L=r(37537),Y={};Y.styleTagTransform=D(),Y.setAttributes=S(),Y.insert=k().bind(null,"head"),Y.domAPI=x(),Y.insertStyleElement=N(),w()(L.Z,Y),L.Z&&L.Z.locals&&L.Z.locals;var K=(0,T.Z)(W,F,[],!1,null,"3f32f7f8",null);K.options.__file="apps/settings/src/components/Encryption.vue";var z=K.exports,H=r(20629);s.ZP.use(H.ZP);var J={setEnforced:function(t,n){s.ZP.set(t,"enforced",n)},setEnforcedGroups:function(t,n){s.ZP.set(t,"enforcedGroups",n)},setExcludedGroups:function(t,n){s.ZP.set(t,"excludedGroups",n)}},Q=new H.yh({strict:!1,state:{enforced:!1,enforcedGroups:[],excludedGroups:[]},mutations:J});r.nc=btoa(OC.requestToken),s.ZP.prototype.t=t,window.OC=window.OC||{},window.OC.Settings=window.OC.Settings||{},Q.replaceState((0,o.loadState)("settings","mandatory2FAState")),new(s.ZP.extend(P))({store:Q}).$mount("#two-factor-auth-settings"),(new(s.ZP.extend(z))).$mount("#vue-admin-encryption")},37537:function(t,n,e){var r=e(87537),o=e.n(r),s=e(23645),a=e.n(s)()(o());a.push([t.id,".notecard.success[data-v-3f32f7f8]{--note-background: rgba(var(--color-success-rgb), 0.2);--note-theme: var(--color-success)}.notecard.error[data-v-3f32f7f8]{--note-background: rgba(var(--color-error-rgb), 0.2);--note-theme: var(--color-error)}.notecard.warning[data-v-3f32f7f8]{--note-background: rgba(var(--color-warning-rgb), 0.2);--note-theme: var(--color-warning)}#body-settings .notecard[data-v-3f32f7f8]{color:var(--color-text-light);background-color:var(--note-background);border:1px solid var(--color-border);border-left:4px solid var(--note-theme);border-radius:var(--border-radius);box-shadow:rgba(43,42,51,.05) 0px 1px 2px 0px;margin:1rem 0;margin-top:1rem;padding:1rem}li[data-v-3f32f7f8]{list-style-type:initial;margin-left:1rem;padding:.25rem 0}.margin-bottom[data-v-3f32f7f8]{margin-bottom:.75rem}","",{version:3,sources:["webpack://./apps/settings/src/components/Encryption.vue"],names:[],mappings:"AA6KA,mCACC,sDAAA,CACA,kCAAA,CAGD,iCACC,oDAAA,CACA,gCAAA,CAGD,mCACC,sDAAA,CACA,kCAAA,CAGD,0CACC,6BAAA,CACA,uCAAA,CACA,oCAAA,CACA,uCAAA,CACA,kCAAA,CACA,6CAAA,CACA,aAAA,CACA,eAAA,CACA,YAAA,CAGD,oBACC,uBAAA,CACA,gBAAA,CACA,gBAAA,CAGD,gCACC,oBAAA",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n\r\n.notecard.success {\r\n\t--note-background: rgba(var(--color-success-rgb), 0.2);\r\n\t--note-theme: var(--color-success);\r\n}\r\n\r\n.notecard.error {\r\n\t--note-background: rgba(var(--color-error-rgb), 0.2);\r\n\t--note-theme: var(--color-error);\r\n}\r\n\r\n.notecard.warning {\r\n\t--note-background: rgba(var(--color-warning-rgb), 0.2);\r\n\t--note-theme: var(--color-warning);\r\n}\r\n\r\n#body-settings .notecard {\r\n\tcolor: var(--color-text-light);\r\n\tbackground-color: var(--note-background);\r\n\tborder: 1px solid var(--color-border);\r\n\tborder-left: 4px solid var(--note-theme);\r\n\tborder-radius: var(--border-radius);\r\n\tbox-shadow: rgba(43, 42, 51, 0.05) 0px 1px 2px 0px;\r\n\tmargin: 1rem 0;\r\n\tmargin-top: 1rem;\r\n\tpadding: 1rem;\r\n}\r\n\r\nli {\r\n\tlist-style-type: initial;\r\n\tmargin-left: 1rem;\r\n\tpadding: 0.25rem 0;\r\n}\r\n\r\n.margin-bottom {\r\n\tmargin-bottom: 0.75rem;\r\n}\r\n"],sourceRoot:""}]),n.Z=a},60964:function(t,n,e){var r=e(87537),o=e.n(r),s=e(23645),a=e.n(s)()(o());a.push([t.id,"\n.two-factor-loading[data-v-20893fad] {\n\tdisplay: inline-block;\n\tvertical-align: sub;\n\tmargin-left: -2px;\n\tmargin-right: 1px;\n}\n.top-margin[data-v-20893fad] {\n\tmargin-top: 0.5rem;\n}\n","",{version:3,sources:["webpack://./apps/settings/src/components/AdminTwoFactor.vue"],names:[],mappings:";AAsKA;CACA,qBAAA;CACA,mBAAA;CACA,iBAAA;CACA,iBAAA;AACA;AAEA;CACA,kBAAA;AACA",sourcesContent:["<template>\r\n\t<NcSettingsSection :title=\"t('settings', 'Two-Factor Authentication')\"\r\n\t\t:description=\"t('settings', 'Two-factor authentication can be enforced for all users and specific groups. If they do not have a two-factor provider configured, they will be unable to log into the system.')\"\r\n\t\t:doc-url=\"twoFactorAdminDoc\">\r\n\t\t<p v-if=\"loading\">\r\n\t\t\t<span class=\"icon-loading-small two-factor-loading\" />\r\n\t\t\t<span>{{ t('settings', 'Enforce two-factor authentication') }}</span>\r\n\t\t</p>\r\n\t\t<NcCheckboxRadioSwitch v-else\r\n\t\t\tid=\"two-factor-enforced\"\r\n\t\t\t:checked.sync=\"enforced\"\r\n\t\t\ttype=\"switch\">\r\n\t\t\t{{ t('settings', 'Enforce two-factor authentication') }}\r\n\t\t</NcCheckboxRadioSwitch>\r\n\t\t<template v-if=\"enforced\">\r\n\t\t\t<h3>{{ t('settings', 'Limit to groups') }}</h3>\r\n\t\t\t{{ t('settings', 'Enforcement of two-factor authentication can be set for certain groups only.') }}\r\n\t\t\t<p class=\"top-margin\">\r\n\t\t\t\t{{ t('settings', 'Two-factor authentication is enforced for all members of the following groups.') }}\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t<NcMultiselect v-model=\"enforcedGroups\"\r\n\t\t\t\t\t:options=\"groups\"\r\n\t\t\t\t\t:placeholder=\"t('settings', 'Enforced groups')\"\r\n\t\t\t\t\t:disabled=\"loading\"\r\n\t\t\t\t\t:multiple=\"true\"\r\n\t\t\t\t\t:searchable=\"true\"\r\n\t\t\t\t\t:loading=\"loadingGroups\"\r\n\t\t\t\t\t:show-no-options=\"false\"\r\n\t\t\t\t\t:close-on-select=\"false\"\r\n\t\t\t\t\t@search-change=\"searchGroup\" />\r\n\t\t\t</p>\r\n\t\t\t<p class=\"top-margin\">\r\n\t\t\t\t{{ t('settings', 'Two-factor authentication is not enforced for members of the following groups.') }}\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t<NcMultiselect v-model=\"excludedGroups\"\r\n\t\t\t\t\t:options=\"groups\"\r\n\t\t\t\t\t:placeholder=\"t('settings', 'Excluded groups')\"\r\n\t\t\t\t\t:disabled=\"loading\"\r\n\t\t\t\t\t:multiple=\"true\"\r\n\t\t\t\t\t:searchable=\"true\"\r\n\t\t\t\t\t:loading=\"loadingGroups\"\r\n\t\t\t\t\t:show-no-options=\"false\"\r\n\t\t\t\t\t:close-on-select=\"false\"\r\n\t\t\t\t\t@search-change=\"searchGroup\" />\r\n\t\t\t</p>\r\n\t\t\t<p class=\"top-margin\">\r\n\t\t\t\t<em>\r\n\t\t\t\t\t\x3c!-- this text is also found in the documentation. update it there as well if it ever changes --\x3e\r\n\t\t\t\t\t{{ t('settings', 'When groups are selected/excluded, they use the following logic to determine if a user has 2FA enforced: If no groups are selected, 2FA is enabled for everyone except members of the excluded groups. If groups are selected, 2FA is enabled for all members of these. If a user is both in a selected and excluded group, the selected takes precedence and 2FA is enforced.') }}\r\n\t\t\t\t</em>\r\n\t\t\t</p>\r\n\t\t</template>\r\n\t\t<p class=\"top-margin\">\r\n\t\t\t<NcButton v-if=\"dirty\"\r\n\t\t\t\ttype=\"primary\"\r\n\t\t\t\t:disabled=\"loading\"\r\n\t\t\t\t@click=\"saveChanges\">\r\n\t\t\t\t{{ t('settings', 'Save changes') }}\r\n\t\t\t</NcButton>\r\n\t\t</p>\r\n\t</NcSettingsSection>\r\n</template>\r\n\r\n<script>\r\nimport axios from '@nextcloud/axios'\r\nimport NcMultiselect from '@nextcloud/vue/dist/Components/NcMultiselect'\r\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton'\r\nimport NcCheckboxRadioSwitch from '@nextcloud/vue/dist/Components/NcCheckboxRadioSwitch'\r\nimport NcSettingsSection from '@nextcloud/vue/dist/Components/NcSettingsSection'\r\nimport { loadState } from '@nextcloud/initial-state'\r\n\r\nimport _ from 'lodash'\r\nimport { generateUrl, generateOcsUrl } from '@nextcloud/router'\r\n\r\nexport default {\r\n\tname: 'AdminTwoFactor',\r\n\tcomponents: {\r\n\t\tNcMultiselect,\r\n\t\tNcButton,\r\n\t\tNcCheckboxRadioSwitch,\r\n\t\tNcSettingsSection,\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tloading: false,\r\n\t\t\tdirty: false,\r\n\t\t\tgroups: [],\r\n\t\t\tloadingGroups: false,\r\n\t\t\ttwoFactorAdminDoc: loadState('settings', 'two-factor-admin-doc'),\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tenforced: {\r\n\t\t\tget() {\r\n\t\t\t\treturn this.$store.state.enforced\r\n\t\t\t},\r\n\t\t\tset(val) {\r\n\t\t\t\tthis.dirty = true\r\n\t\t\t\tthis.$store.commit('setEnforced', val)\r\n\t\t\t},\r\n\t\t},\r\n\t\tenforcedGroups: {\r\n\t\t\tget() {\r\n\t\t\t\treturn this.$store.state.enforcedGroups\r\n\t\t\t},\r\n\t\t\tset(val) {\r\n\t\t\t\tthis.dirty = true\r\n\t\t\t\tthis.$store.commit('setEnforcedGroups', val)\r\n\t\t\t},\r\n\t\t},\r\n\t\texcludedGroups: {\r\n\t\t\tget() {\r\n\t\t\t\treturn this.$store.state.excludedGroups\r\n\t\t\t},\r\n\t\t\tset(val) {\r\n\t\t\t\tthis.dirty = true\r\n\t\t\t\tthis.$store.commit('setExcludedGroups', val)\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\tmounted() {\r\n\t\t// Groups are loaded dynamically, but the assigned ones *should*\r\n\t\t// be valid groups, so let's add them as initial state\r\n\t\tthis.groups = _.sortedUniq(_.uniq(this.enforcedGroups.concat(this.excludedGroups)))\r\n\r\n\t\t// Populate the groups with a first set so the dropdown is not empty\r\n\t\t// when opening the page the first time\r\n\t\tthis.searchGroup('')\r\n\t},\r\n\tmethods: {\r\n\t\tsearchGroup: _.debounce(function(query) {\r\n\t\t\tthis.loadingGroups = true\r\n\t\t\taxios.get(generateOcsUrl('cloud/groups?offset=0&search={query}&limit=20', { query }))\r\n\t\t\t\t.then(res => res.data.ocs)\r\n\t\t\t\t.then(ocs => ocs.data.groups)\r\n\t\t\t\t.then(groups => { this.groups = _.sortedUniq(_.uniq(this.groups.concat(groups))) })\r\n\t\t\t\t.catch(err => console.error('could not search groups', err))\r\n\t\t\t\t.then(() => { this.loadingGroups = false })\r\n\t\t}, 500),\r\n\r\n\t\tsaveChanges() {\r\n\t\t\tthis.loading = true\r\n\r\n\t\t\tconst data = {\r\n\t\t\t\tenforced: this.enforced,\r\n\t\t\t\tenforcedGroups: this.enforcedGroups,\r\n\t\t\t\texcludedGroups: this.excludedGroups,\r\n\t\t\t}\r\n\t\t\taxios.put(generateUrl('/settings/api/admin/twofactorauth'), data)\r\n\t\t\t\t.then(resp => resp.data)\r\n\t\t\t\t.then(state => {\r\n\t\t\t\t\tthis.state = state\r\n\t\t\t\t\tthis.dirty = false\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tconsole.error('could not save changes', err)\r\n\t\t\t\t})\r\n\t\t\t\t.then(() => { this.loading = false })\r\n\t\t},\r\n\t},\r\n}\r\n<\/script>\r\n\r\n<style scoped>\r\n\t.two-factor-loading {\r\n\t\tdisplay: inline-block;\r\n\t\tvertical-align: sub;\r\n\t\tmargin-left: -2px;\r\n\t\tmargin-right: 1px;\r\n\t}\r\n\r\n\t.top-margin {\r\n\t\tmargin-top: 0.5rem;\r\n\t}\r\n</style>\r\n"],sourceRoot:""}]),n.Z=a}},r={};function o(t){var n=r[t];if(void 0!==n)return n.exports;var s=r[t]={id:t,loaded:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.loaded=!0,s.exports}o.m=e,o.amdD=function(){throw new Error("define cannot be used indirect")},o.amdO={},n=[],o.O=function(t,e,r,s){if(!e){var a=1/0;for(l=0;l<n.length;l++){e=n[l][0],r=n[l][1],s=n[l][2];for(var i=!0,c=0;c<e.length;c++)(!1&s||a>=s)&&Object.keys(o.O).every((function(t){return o.O[t](e[c])}))?e.splice(c--,1):(i=!1,s<a&&(a=s));if(i){n.splice(l--,1);var d=r();void 0!==d&&(t=d)}}return t}s=s||0;for(var l=n.length;l>0&&n[l-1][2]>s;l--)n[l]=n[l-1];n[l]=[e,r,s]},o.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(n,{a:n}),n},o.d=function(t,n){for(var e in n)o.o(n,e)&&!o.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},o.j=788,function(){o.b=document.baseURI||self.location.href;var t={788:0};o.O.j=function(n){return 0===t[n]};var n=function(n,e){var r,s,a=e[0],i=e[1],c=e[2],d=0;if(a.some((function(n){return 0!==t[n]}))){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(c)var l=c(o)}for(n&&n(e);d<a.length;d++)s=a[d],o.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return o.O(l)},e=self.webpackChunknextcloud=self.webpackChunknextcloud||[];e.forEach(n.bind(null,0)),e.push=n.bind(null,e.push.bind(e))}(),o.nc=void 0;var s=o.O(void 0,[7874],(function(){return o(99989)}));s=o.O(s)}();
//# sourceMappingURL=settings-vue-settings-admin-security.js.map?v=04d261aad0fc6ca62573